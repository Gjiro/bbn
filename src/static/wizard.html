<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Era Balance Sheet System</title>
    <link rel="stylesheet" href="wizard.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üíº Elite Era Balance Sheet System</h1>
        </div>

        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('dashboard')">üåü ELITE ERA DASHBOARD</button>
            <button class="tab" onclick="switchTab('entry')">üìù Balance Entry</button>
            <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è Settings & Management</button>
            <button class="tab" onclick="switchTab('reports')">üìä Reports</button>
        </div>

        <!-- Elite Era Dashboard Tab -->
        <div id="dashboardTab" class="tab-content active">
            <!-- Main Dashboard Header -->
            <div class="elite-dashboard-header">
                <h2 class="elite-title">üåü ELITE ERA CONSOLIDATED POSITION</h2>
                <p class="elite-subtitle">Real-time financial overview across all stores</p>
                <div class="last-updated" id="lastUpdated">Last updated: Loading...</div>
            </div>

            <!-- Main KPI Cards -->
            <div class="elite-kpi-grid">
                <div class="elite-kpi-card total-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-label">TOTAL ASSETS</div>
                    <div class="kpi-value" id="eliteTotalAssets">$0.00</div>
                    <div class="kpi-trend positive" id="assetsTrend">‚Üë Loading...</div>
                </div>

                <div class="elite-kpi-card liability-card">
                    <div class="kpi-icon">üí≥</div>
                    <div class="kpi-label">TOTAL LIABILITIES</div>
                    <div class="kpi-value" id="eliteTotalLiabilities">$0.00</div>
                    <div class="kpi-trend negative" id="liabilitiesTrend">‚Üì Loading...</div>
                </div>

                <div class="elite-kpi-card net-position-card">
                    <div class="kpi-icon">üéØ</div>
                    <div class="kpi-label">NET POSITION</div>
                    <div class="kpi-value highlight" id="eliteNetPosition">$0.00</div>
                    <div class="kpi-trend" id="netPositionTrend">‚Üë Loading...</div>
                </div>

                <div class="elite-kpi-card profit-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-label">YTD PROFIT</div>
                    <div class="kpi-value" id="eliteYtdProfit">$0.00</div>
                    <div class="kpi-trend positive" id="profitTrend">‚Üë Loading...</div>
                </div>
            </div>

            <!-- Store Breakdown Section -->
            <div class="elite-stores-section">
                <h3 class="section-title">üìä Store Breakdown</h3>
                <div class="stores-breakdown-grid" id="storesBreakdownGrid">
                    <!-- Store cards will be dynamically populated here -->
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="elite-actions">
                <button class="btn btn-primary" onclick="refreshDashboard()">üîÑ Refresh Dashboard</button>
                <button class="btn btn-success" onclick="switchTab('entry')">‚ûï New Balance Entry</button>
                <button class="btn btn-warning" onclick="exportDashboard()">üì• Export Report</button>
            </div>

            <!-- Charts Section -->
            <div class="elite-charts-section">
                <div class="chart-container">
                    <h3>Asset Distribution by Store</h3>
                    <canvas id="assetChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>30-Day Trend</h3>
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Entry Tab -->
        <div id="entryTab" class="tab-content">
            <div class="top-controls">
                <div class="controls-left">
                    <select id="storeSelect">
                        <option value="">Select Store...</option>
                    </select>
                    <input type="date" id="snapshotDate">
                    <button onclick="loadPreviousSnapshot()">üìã Load Previous</button>
                    <button onclick="loadDrafts()">üìÇ My Drafts</button>
                    <button onclick="clearAll()">üóëÔ∏è Clear All</button>
                </div>
                <div class="controls-right">
                    <button class="btn-warning" onclick="saveDraft()">üíæ Save Draft</button>
                    <button class="btn-success" onclick="publishSnapshot()">‚úÖ Publish</button>
                </div>
            </div>

            <div class="message" id="message"></div>

            <div class="main-layout">
                <div class="entries-panel">
                    <!-- Assets Section -->
                    <div class="category-section">
                        <div class="category-header assets" onclick="toggleCategory('assets')">
                            <div class="category-title">
                                <span class="collapse-icon">‚ñº</span>
                                üí∞ ASSETS
                            </div>
                            <div class="category-total" id="assetTotal">$0.00</div>
                        </div>
                        <div class="category-content" id="assetsContent">
                            <!-- Bank Accounts -->
                            <div class="account-group">
                                <div class="account-group-title">
                                    Bank Accounts
                                    <button class="btn-small" onclick="addAccountToGroup('bank')">+ Add</button>
                                </div>
                                <div id="bankAccounts"></div>
                            </div>
                            <!-- Merchant Accounts -->
                            <div class="account-group">
                                <div class="account-group-title">
                                    Merchant Accounts
                                    <button class="btn-small" onclick="addAccountToGroup('merchant')">+ Add</button>
                                </div>
                                <div id="merchantAccounts"></div>
                            </div>
                            <!-- Inventory -->
                            <div class="account-group">
                                <div class="account-group-title">
                                    Inventory
                                    <button class="btn-small" onclick="addAccountToGroup('inventory')">+ Add</button>
                                </div>
                                <div id="inventory"></div>
                            </div>
                            <!-- Other Assets -->
                            <div class="account-group">
                                <div class="account-group-title">
                                    Other Assets
                                    <button class="btn-small" onclick="addAccountToGroup('other-assets')">+ Add</button>
                                </div>
                                <div id="receivables"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Liabilities Section -->
                    <div class="category-section">
                        <div class="category-header liabilities" onclick="toggleCategory('liabilities')">
                            <div class="category-title">
                                <span class="collapse-icon">‚ñº</span>
                                üí≥ LIABILITIES
                            </div>
                            <div class="category-total" id="liabilityTotal">$0.00</div>
                        </div>
                        <div class="category-content" id="liabilitiesContent">
                            <div class="account-group">
                                <div class="account-group-title">
                                    Payables & Obligations
                                    <button class="btn-small" onclick="addAccountToGroup('payables')">+ Add</button>
                                </div>
                                <div id="liabilities"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Summary Panel with Detailed Breakdown -->
                <div class="summary-panel">
                    <h3 class="summary-title">üìä Balance Sheet Summary</h3>
                    
                    <!-- Net Position at Top -->
                    <div class="net-position">
                        <div>NET POSITION</div>
                        <div id="netPosition" style="font-size: 24px; font-weight: bold;">$0.00</div>
                    </div>
                    
                    <!-- Assets Breakdown Section -->
                    <div class="summary-section">
                        <div class="summary-section-header" onclick="toggleSummarySection('assetsBreakdown')">
                            <span class="summary-toggle-icon" id="assetsBreakdownToggle">‚ñº</span>
                            <span>ASSETS</span>
                            <span id="totalAssets" class="total-assets">$0.00</span>
                        </div>
                        <div class="summary-details" id="assetsBreakdown">
                            <div class="summary-subsection">
                                <div class="summary-subsection-title">Bank Accounts</div>
                                <div id="summaryBankAccounts" class="summary-items"></div>
                            </div>
                            <div class="summary-subsection">
                                <div class="summary-subsection-title">Merchant Accounts</div>
                                <div id="summaryMerchantAccounts" class="summary-items"></div>
                            </div>
                            <div class="summary-subsection">
                                <div class="summary-subsection-title">Inventory</div>
                                <div id="summaryInventory" class="summary-items"></div>
                            </div>
                            <div class="summary-subsection">
                                <div class="summary-subsection-title">Other Assets</div>
                                <div id="summaryOtherAssets" class="summary-items"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Liabilities Breakdown Section -->
                    <div class="summary-section">
                        <div class="summary-section-header" onclick="toggleSummarySection('liabilitiesBreakdown')">
                            <span class="summary-toggle-icon" id="liabilitiesBreakdownToggle">‚ñº</span>
                            <span>LIABILITIES</span>
                            <span id="totalLiabilities" class="total-liabilities">$0.00</span>
                        </div>
                        <div class="summary-details" id="liabilitiesBreakdown">
                            <div id="summaryLiabilities" class="summary-items"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settingsTab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-sidebar">
                    <div class="settings-menu-item active" onclick="showSettingsSection('drafts')">
                        üìù Pending Drafts
                    </div>
                    <div class="settings-menu-item" onclick="showSettingsSection('categories')">
                        üìö All Categories
                    </div>
                    <div class="settings-menu-item" onclick="showSettingsSection('accounts')">
                        üíº All Accounts
                    </div>
                    <div class="settings-menu-item" onclick="showSettingsSection('move')">
                        üîÑ Move Accounts
                    </div>
                    <div class="settings-menu-item" onclick="showSettingsSection('helpers')">
                        üîß Line Item Helpers
                    </div>
                    <div class="settings-menu-item" onclick="showSettingsSection('import')">
                        üì• Bulk Import
                    </div>
                </div>
                <div class="settings-content" id="settingsContent">
                    <!-- Content will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reportsTab" class="tab-content">
            <div style="padding: 40px; text-align: center;">
                <h2>üìä Reports Section</h2>
                <p>Detailed reports and analytics will be displayed here</p>
                <button class="btn btn-primary" onclick="generateMonthlyReport()">Generate Monthly Report</button>
                <button class="btn btn-primary" onclick="generateYearlyReport()">Generate Yearly Report</button>
            </div>
        </div>
    </div>

    <!-- Move Account Modal -->
    <div id="moveAccountModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Move Account</h3>
                <button onclick="closeMoveModal()" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Account:</label>
                    <input type="text" id="moveAccountName" class="form-input" readonly>
                </div>
                <div class="form-group">
                    <label>Move to Category:</label>
                    <select id="moveCategorySelect" class="form-input">
                        <option value="">Select Category...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Move to Subcategory:</label>
                    <select id="moveSubcategorySelect" class="form-input">
                        <option value="">Select Subcategory...</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMoveModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmMove()">Move Account</button>
            </div>
        </div>
    </div>

    <!-- Add Account Modal -->
    <div id="addAccountModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Account</h3>
                <button onclick="closeAddAccountModal()" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Account Name:</label>
                    <input type="text" id="newAccountName" class="form-input" placeholder="Enter account name">
                </div>
                <div class="form-group">
                    <label>Account Type:</label>
                    <select id="newAccountType" class="form-input">
                        <option value="">Select Type...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Bank (optional):</label>
                    <select id="newAccountBank" class="form-input">
                        <option value="">Select Bank...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Account Number (optional):</label>
                    <input type="text" id="newAccountNumber" class="form-input" placeholder="Last 4 digits">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddAccountModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmAddAccount()">Add Account</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <script src="wizard.js"></script>
    <!-- Add Chart.js for the dashboard charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
